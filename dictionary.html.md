# 字典Dictionary


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

在Python中除了序列数据结构，字典作为一种键值对的映射数据结构，通过键(key)而不是数字索引来查找相关值。作为一种重要的数据结构，它是可变的并且无序的键值对集合。

<div class="callout_note">

在字典中，键是作为字典的索引，必须是唯一的，这样才能确保通过键可以找到相同的值，并且可以利用[哈希表](https://cloud.tencent.com/developer/article/1432801)快速查找

</div>

## 创建

使用花括号{}创建，键和值用冒号:分隔,不同项之间用逗号,分隔。

``` python
empty_dict = {}
coffee_dict = {'瑞幸': 10, '星巴克': 15, 'manner': 30, 'M stand': 35}
```

## 键的特性

在字典中，键除了唯一的以外，必须是不可变类型。键可以是任何不可变类型；字符串和数字总是可以作为键。
如果一个元组只包含字符串、数字或元组则也可以作为键；如果一个元组直接或间接地包含了任何可变对象，则
**不能作为键** 。
列表不能作为键，因为列表可以使用索引赋值、切片赋值或者`append()`和`extend()`等方法进行原地修改列表。

## 访问值

区别于序列数据结构，字典中的值是通过键作为索引访问的。

``` python
print(f"瑞幸剩余库存是:{coffee_dict['瑞幸']}")
```

    瑞幸剩余库存是:10

## 修改和添加

通过按照`dict[key] = value`的格式可以快速实现修改或者添加新的键值对。

``` python
coffee_dict['星巴克'] = 23
coffee_dict
```

    {'瑞幸': 10, '星巴克': 23, 'manner': 30, 'M stand': 35}

``` python
coffee_dict['Beets Coffee'] = 50
coffee_dict
```

    {'瑞幸': 10, '星巴克': 23, 'manner': 30, 'M stand': 35, 'Beets Coffee': 50}

## 删除

``` python
del coffee_dict['Beets Coffee']
```

``` python
coffee_dict_modified = coffee_dict.pop('manner')
```

``` python
coffee_dict_modified
```

    30

``` python
coffee_dict
```

    {'瑞幸': 10, '星巴克': 23, 'M stand': 35}

## 常用方法

下面罗列一些常用方法

``` python
coffee_dict.keys()
```

    dict_keys(['瑞幸', '星巴克', 'M stand'])

``` python
coffee_dict.values()
```

    dict_values([10, 23, 35])

``` python
coffee_dict.items()
```

    dict_items([('瑞幸', 10), ('星巴克', 23), ('M stand', 35)])

``` python
coffee_dict.get('M stand')
```

    35

``` python
coffee_dict.update({'Beets Coffee': 24})
```

``` python
coffee_dict
```

    {'瑞幸': 10, '星巴克': 23, 'M stand': 35, 'Beets Coffee': 24}

## 字典推导式

类似于列表推导式，字典也有自己方式快速建立字典

``` python
squares = {x: x**2 for x in range(5)}
```

``` python
squares
```

    {0: 0, 1: 1, 2: 4, 3: 9, 4: 16}

字典的查找、插入和删除操作都是十分高效的

#### 课后作业

利用字典的功能设计一个简单的聊天机器人，可以将用户常用的对话用字典的形式保存起来，用户通过选择固定的问题得到机器人的回答。

## `defaultdict`对象

在`collections`模块中，`defaultdict`是内置`dict`类的子类，当你尝试访问字典中不存在的键时，它会自动创建一个默认值，而不是抛出`KeyError`.

``` python
from collections import defaultdict

# 统计单词出现次数
text = "the quick brown fox jumps over the lazy dog"
word_count = defaultdict(int)  # 默认值为0
for word in text.split():
    word_count[word] += 1  # 不存在的键会自动初始化为0

print(word_count)
```

    defaultdict(<class 'int'>, {'the': 2, 'quick': 1, 'brown': 1, 'fox': 1, 'jumps': 1, 'over': 1, 'lazy': 1, 'dog': 1})

可以用于一下场景： 1. 计数统计 2. 分组操作 3.
创建复杂的数据结构，例如图的邻接表 4. 处理可能存在缺失健的数据

``` python
# 创建邻接表表示的图
graph = defaultdict(list)
edges = [(1, 2), (2, 3), (3, 1), (2, 4)]

for start, end in edges:
    graph[start].append(end)  # 不需要检查键是否存在

print(dict(graph))
```

    {1: [2], 2: [3, 4], 3: [1]}

## `Counter`对象

在`collections`模块中有个一专门用于计数的对象`Counter`.

``` python
from collections import Counter

# 基础用法
text = "mississippi"
counter = Counter(text)
print(counter)  # Counter({'i': 4, 's': 4, 'p': 2, 'm': 1})

# Counter 的一些实用方法
print(counter.most_common(2))  # 获取出现次数最多的2个元素: [('i', 4), ('s', 4)]
print(list(counter.elements()))  # 展开所有元素: ['m', 'i', 'i', 'i', 'i', 's', 's', 's', 's', 'p', 'p']

# Counter 支持数学运算
counter1 = Counter(['a', 'b', 'b', 'c'])
counter2 = Counter(['b', 'b', 'c', 'd'])
print(counter1 + counter2)  # 合并计数: Counter({'b': 4, 'c': 2, 'a': 1, 'd': 1})
print(counter1 - counter2)  # 减去计数: Counter({'a': 1})
```

    Counter({'i': 4, 's': 4, 'p': 2, 'm': 1})
    [('i', 4), ('s', 4)]
    ['m', 'i', 'i', 'i', 'i', 's', 's', 's', 's', 'p', 'p']
    Counter({'b': 4, 'c': 2, 'a': 1, 'd': 1})
    Counter({'a': 1})

``` python
# 假设我们有一些网站访问日志
logs = [
    ('2024-01-01', 'user1', 'login'),
    ('2024-01-01', 'user2', 'view'),
    ('2024-01-01', 'user1', 'view'),
    ('2024-01-02', 'user1', 'login')
]

# 使用 Counter 统计每个操作的总次数
action_counts = Counter(action for _, _, action in logs)
print("操作统计:", action_counts)
```

    操作统计: Counter({'login': 2, 'view': 2})
